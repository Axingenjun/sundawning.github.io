!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((n="undefined"!=typeof globalThis?globalThis:n||self).termux_robot_utility={})}(this,(function(n){"use strict";function e(n){let{execSync:e}=require("child_process");return e(n)}function t(){let{existsSync:n}=require("fs");!0!==n("./node_modules/")&&e("npm init -y")}function o(){switch(process.platform){case"win32":return"where";case"android":return"which";default:return""}}function i(){t();try{e(`${o()} pnpm`)}catch(n){e("npm install pnpm -g")}}function r(n){let{existsSync:t}=require("fs");!0!==t(`./node_modules/${n}`)&&(i(),console.log(`将安装模块：${n}`),e(`pnpm add ${n} --save-dev`),console.log(`已安装模块：${n}`))}function c(n){return r(n),require(n)}async function s(){return await c("ps-list")()}function a(n,e){return console.log(`启动程序：${n.program} ${n.args.join(" ")}`),c("cross-spawn").sync(n.program,n.args,e)}function l(n,e,t){let o=c("which");o(n,(function(i,r){i?(console.log(`未安装程序：${n}`),console.log(`将安装程序：${n}`),a(e),o(n,(function(e,o){e?console.log(`无法安装程序：${n}`):t&&t()}))):t&&t()}))}async function u(n){if(void 0===n)return;let e=await s();Object.keys(n).forEach((function(t){0===e.filter((function(n){return n.name===t})).length?l(t,n[t].install,(function(){a(n[t].cmd)})):console.log(`已启动程序：${t}`)}))}n.child_process_exec_sync=e,n.create_crontab_tasks=async function n(e){void 0!==e&&(await u({crond:{cmd:{program:"crond",args:[]},install:{program:"pkg",args:["install","cronie","-y"]}}}),c("crontab").load((function(t,o){if(null===o)return void n(e);let i=o.jobs().map((function(n){return n.toString()}));e.forEach((function(n){!0!==i.includes(n.join(" "))&&(o.create(n[1],n[0]),console.log("创建任务：",n[0],n[1]))})),o.save()})))},n.download_file=async function(n,e){let{fetch:t}=c("node-fetch"),o=await t(n,{method:"GET",headers:{"Content-Type":"application/octet-stream"}}),i=await o.buffer(),{writeFileSync:r}=require("fs");r(e,i,"binary"),console.log("下载成功：",n,"=>",e)},n.get_platform_which_command=o,n.get_process_list=s,n.hello=function(){console.log("欢迎")},n.install_program=l,n.install_require_module=c,n.npm_config_set_regisitry_taobao=function(){return e("npm config set registry https://registry.npm.taobao.org")},n.npm_init_y=t,n.pnpm_add_save_dev=r,n.pnpm_init_y=i,n.start_process=a,n.start_processes=u,n.termux_notification=function(n){void 0===n&&(n={});let e=[];Object.keys(n).forEach((function(t){e.push(t,n[t])})),l("termux-notification",{program:"pkg",args:["install","termux-api","-y"]},(function(){a({program:"termux-notification",args:e})}))},Object.defineProperty(n,"__esModule",{value:!0})}));
