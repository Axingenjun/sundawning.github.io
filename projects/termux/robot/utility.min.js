!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((n="undefined"!=typeof globalThis?globalThis:n||self).termux_robot_utility={})}(this,(function(n){"use strict";function e(n){let{execSync:e}=require("child_process");return e(n)}function o(){let{existsSync:n}=require("fs");!0!==n("./node_modules/")&&e("npm init -y")}function t(){switch(process.platform){case"win32":return"where";case"android":return"which";default:return""}}function i(){o();try{e(`${t()} pnpm`)}catch(n){e("npm install pnpm -g")}}function r(n){let{existsSync:o}=require("fs");!0!==o(`./node_modules/${n}`)&&(i(),console.log(`将安装模块：${n}`),e(`pnpm add ${n} --save-dev`),console.log(`已安装模块：${n}`))}function c(n){return r(n),require(n)}async function s(){return await c("ps-list")()}function a(n,e){return console.log(`启动程序：${n.program} ${n.args.join(" ")}`),c("cross-spawn").sync(n.program,n.args,e)}function l(n,e,o){let t=c("which");t(n,(function(i,r){i?(console.log(`未安装程序：${n}`),console.log(`将安装程序：${n}`),a(e),t(n,(function(e,t){e?console.log(`无法安装程序：${n}`):o&&o()}))):o&&o()}))}async function u(n){if(void 0===n)return;let e=await s();Object.keys(n).forEach((function(o){0===e.filter((function(n){return n.name===o})).length?l(o,n[o].install,(function(){a(n[o].cmd)})):console.log(`已启动程序：${o}`)}))}n.child_process_exec_sync=e,n.create_crontab_tasks=async function n(e){void 0!==e&&(await u({crond:{cmd:{program:"crond",args:[]},install:{program:"pkg",args:["install","cronie","-y"]}}}),c("crontab").load((function(o,t){if(null===t)return void n(e);let i=t.jobs().map((function(n){return n.toString()}));e.forEach((function(n){!0!==i.includes(n.join(" "))&&(t.create(n[1],n[0]),console.log("创建任务：",n[0],n[1]))})),t.save()})))},n.download_file=function(n,e){c("node-fetch")(n,{method:"GET",headers:{"Content-Type":"application/octet-stream"}}).then((function(n){return n.buffer()})).then((function(o){require("fs").writeFile(e,o,"binary",(function(o){o?console.log(o):console.log("下载成功：",n,"=>",e)}))}))},n.get_platform_which_command=t,n.get_process_list=s,n.hello=function(){console.log("欢迎")},n.install_program=l,n.install_require_module=c,n.npm_config_set_regisitry_taobao=function(){return e("npm config set registry https://registry.npm.taobao.org")},n.npm_init_y=o,n.pnpm_add_save_dev=r,n.pnpm_init_y=i,n.start_process=a,n.start_processes=u,n.termux_notification=function(n){void 0===n&&(n={});let e=[];Object.keys(n).forEach((function(o){e.push(o,n[o])})),l("termux-notification",{program:"pkg",args:["install","termux-api","-y"]},(function(){a({program:"termux-notification",args:e})}))},Object.defineProperty(n,"__esModule",{value:!0})}));
