!function(n){"function"==typeof define&&define.amd?define(n):n()}((function(){"use strict";function n(n){let{execSync:o}=require("child_process");return o(n)}function o(){!function(){let{existsSync:o}=require("fs");!0!==o("./node_modules/")&&n("npm init -y")}();try{n(`${function(){switch(process.platform){case"win32":return"where";case"android":return"which";default:return""}}()} pnpm`)}catch(o){n("npm install pnpm -g")}}function r(r){return function(r){let{existsSync:t}=require("fs");!0!==t(`./node_modules/${r}`)&&(o(),console.log(`将安装模块：${r}`),n(`pnpm add ${r} --save-dev`),console.log(`已安装模块：${r}`))}(r),require(r)}function t(n,o){return console.log(`启动程序：${n.program} ${n.args.join(" ")}`),r("cross-spawn").sync(n.program,n.args,o)}function a(n,o,a){let i=r("which");i(n,(function(r,e){r?(console.log(`未安装程序：${n}`),console.log(`将安装程序：${n}`),t(o),i(n,(function(o,r){o?console.log(`无法安装程序：${n}`):a&&a()}))):a&&a()}))}async function i(n){if(void 0===n)return;let o=await async function(){return await r("ps-list")()}();Object.keys(n).forEach((function(r){0===o.filter((function(n){return n.name===r})).length?a(r,n[r].install,(function(){t(n[r].cmd)})):console.log(`已启动程序：${r}`)}))}async function e(n){void 0!==n&&(await i({crond:{cmd:{program:"crond",args:[]},install:{program:"pkg",args:["install","cronie","-y"]}}}),r("crontab").load((function(o,r){if(null===r)return void e(n);let t=r.jobs().map((function(n){return n.toString()}));n.forEach((function(n){!0!==t.includes(n.join(" "))&&(r.create(n[1],n[0]),console.log("创建任务：",n[0],n[1]))})),r.save()})))}!async function(){console.log("欢迎"),a("pm2",{program:"pnpm",args:["add","pm2","-g"]},(function(){i({mysqld:{cmd:{program:"pm2",args:["start","mysqld"]},install:{program:"pkg",args:["install","mariadb","-y"]}}}),t({program:"pm2",args:["start","koa.min.js"]})})),await i({sshd:{cmd:{program:"sshd",args:["-p","8022"]},install:{program:"pkg",args:["install","openssh","-y"]}}}),await e([["30 8 * * *","am start -n com.alibaba.android.rimet/com.alibaba.android.rimet.biz.LaunchHomeActivity"],["0 18 * * *","am start -n com.alibaba.android.rimet/com.alibaba.android.rimet.biz.LaunchHomeActivity"]])}()}));
