<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0,minimum-scale=1,maximum-scale=1">
    <meta charset="utf-8">
    <title>时薪计算器</title>
    <style type="text/css">
      #app {
        display: flex;
        align-items: center;
        flex-direction: column;
        justify-content: center;
      }
      #logo {
        width: 120px;
        height: 120px;
        display: flex;
        align-items: center;
      }
      #logo a {
        height: fit-content;
      }
      #logo img {
        width: 100%;
      }
    </style>
  </head>
  <body>
    <div id="app">
      <h1 id="title"></h1>
      <form name="current" style="text-align:right;line-height:32px;max-width:320px;margin:0 auto;">
        <div><input type="radio" name="n" value="x"/>时薪(元/小时)：<input type="number" name="x"/></div>
        <div><input type="radio" name="n" value="y" checked="true"/>每月总工资(元)：<input type="number" name="y"/></div>
        <div><strong>法定工作日</strong><strong>法定八小时</strong>之内的工作时长(小时)：<input type="number" name="a"/></div>
        <div><strong>法定工作日</strong>八小时之外加班的至少<strong>1.5</strong>倍时薪的工作时长(小时)：<input type="number" name="b"/></div>
        <div>是否是大小周：<input type="checkbox" name="m"/></div>
        <div><strong>法定休息日</strong>周六加班的至少<strong>2</strong>倍时薪的工作时长(小时)：<input type="number" name="c"/></div>
        <div><strong>法定休息日</strong>周日加班的至少<strong>2</strong>倍时薪的工作时长(小时)：<input type="number" name="d"/></div>
        <div><strong>法定节假日</strong>加班的至少<strong>3</strong>倍的时薪工作时长(小时)：<input type="number" name="e"/></div>
      </form>
      <div id="logo">
        <a href="../../index.html">
          <script type="text/javascript" src="../../projects/random-bing-image/index.js"></script><script type="text/javascript">new RandomBingImage().randomBingImageAfterDOMElement(document.currentScript);</script>
        </a>
      </div>
    </div>
    <script type="text/javascript">
      /**
       * 计算每月工作时长
       */
      function computeHours(a,b,c,d,e,m){
        return (a*21.75+b*1.5*21.75+c*2*(52/12)*(1-m*0.5)+d*2*(52/12)+e*3*(11/12));
      }
      /**
       * 每月总工资：法定工作天数21.75，一年共52周(52个双休)，11天法定节假日。
       * @param {0|1} m 是大小周时为1，不是大小周时为0。
       */
      function computeY(x,a,b,c,d,e,m){
        return x*computeHours(a,b,c,d,e,m);
      }
      /**
       * 时薪
       */
      function computeX(y,a,b,c,d,e,m){
        console.log(arguments);
        return y/computeHours(a,b,c,d,e,m);
      }
      /**
       * 计算表单所填数据的时薪
       */
      function computeFormX(form){
        let elements=form.elements;
        let y=getY(elements.y.value);
        let a=getA(elements.a.value);
        let b=getB(elements.b.value);
        let c=getC(elements.c.value);
        let d=getD(elements.d.value);        
        let e=getE(elements.e.value);
        let m=getM(elements.m.checked);
        let x=computeX(y,a,b,c,d,e,m);
        return x;
      }
      /**
       * 计算表单所填数据的每月总工资
       */
      function computeFormY(form){
        let elements=form.elements;
        let x=getX(elements.x.value);
        let a=getA(elements.a.value);
        let b=getB(elements.b.value);
        let c=getC(elements.c.value);
        let d=getD(elements.d.value);        
        let e=getE(elements.e.value);
        let m=getM(elements.m.checked);
        let y=computeY(x,a,b,c,d,e,m);
        return y;
      }
      /**
       * 从输入的数值里提取出合法的时薪
       */
      function getX(value){
        let item;
        {
          if(value===""){
            item=0;
          }else{
            let float=parseFloat(value);
            if(float<0){
              item=0;
            }else{
              item=float;
            }
          }
        }
        return item;
      }
      /**
       * 从输入的数值里提取出合法的每月总工资
       */
      function getY(value){
        let item;
        {
          if(value===""){
            item=0;
          }else{
            let float=parseFloat(value);
            if(float<0){
              item=0;
            }else{
              item=float;
            }
          }
        }
        return item;
      }
      /**
       * 从输入的数值里提取出合法的
       * 法定工作日法定八小时之内的工作时长
       */
      function getA(value){
        let item;
        {
          if(value===""){
            item=8;
          }else{
            let float=parseFloat(value);
            if(float<0){
              item=8;
            }else if(float===0){
              item=8;
            }else if(float>8){
              item=8;
            }else{
              item=float;
            }
          }
        }
        return item;
      }
      /**
       * 从输入的数值里提取出合法的
       * 法定工作日八小时之外加班的至少1.5倍时薪的工作时长
       */
      function getB(value){
        let item;
        {
          if(value===""){
            item=0;
          }else{
            let float=parseFloat(value);
            if(float<0){
              item=0;
            }else if(float>(24-8)){
              item=24-8;
            }else{
              item=float;
            }
          }
        }
        return item;
      }
      /**
       * 从输入的数值里提取出合法的
       * 法定休息日周六加班的至少2倍时薪的工作时长
       */
      function getC(value){
        let item;
        {
          if(value===""){
            item=0;
          }else{
            let float=parseFloat(value);
            if(float<0){
              item=0;
            }else if(float>24){
              item=24;
            }else{
              item=float;
            }
          }
        }
        return item;
      }
      /**
       * 从输入的数值里提取出合法的
       * 法定休息日周日加班的至少2倍时薪的工作时长
       */
      function getD(value){
        let item;
        {
          if(value===""){
            item=0;
          }else{
            let float=parseFloat(value);
            if(float<0){
              item=0;
            }else if(float>24){
              item=24;
            }else{
              item=float;
            }
          }
        }
        return item;
      }
      /**
       * 从输入的数值里提取出合法的
       * 法定节假日加班的至少3倍的时薪工作时长
       */
      function getE(value){
        let item;
        {
          if(value===""){
            item=0;
          }else{
            let float=parseFloat(value);
            if(float<0){
              item=0;
            }else if(float>24){
              item=24;
            }else{
              item=float;
            }
          }
        }
        return item;
      }
      /**
       * 从多选框里提取出合法的
       * 是否是大小周
       */
      function getM(checked){
        let item;
        {
          if(checked===false){
            item=0;
          }else{
            item=1;
          }
        }
        return item;
      }
      let form=document.getElementsByName("current")[0];
      let n=form.elements.n.value;
      if(n==="y"){
        form.x.disabled=true;
        form.y.disabled=false;
      }
      if(n==="x"){
        form.x.disabled=false;
        form.y.disabled=true;
      }
      form.addEventListener("change",function(event){
        let n=form.elements.n.value;
        if(n==="y"){
          form.x.disabled=true;
          form.y.disabled=false;
          let x=document.getElementsByName("x")[0];
          x.value=computeFormX(form);
        }else if(n==="x"){
          form.x.disabled=false;
          form.y.disabled=true;
          let y=document.getElementsByName("y")[0];
          y.value=computeFormY(form);
        }
        document.querySelector("#title").innerHTML=`${getX(form.x.value)}<sub>元/小时</sub> * ${getY(form.y.value)/getX(form.x.value)}<sub>小时/月</sub> = ${getY(form.y.value)}<sub>元/月</sub>`;
      });
      document.querySelector("#title").innerHTML=`${getX(form.x.value)}<sub>元/小时</sub> * ${getY(form.y.value)/getX(form.x.value)}<sub>小时/月</sub> = ${getY(form.y.value)}<sub>元/月</sub>`;
    </script>
  </body>
</html>
